var WL=(()=>{var dt=Object.defineProperty;var ht=(o,t)=>{for(var e in t)dt(o,e,{get:t[e],enumerable:!0})};var Wt={};ht(Wt,{Alignment:()=>wt,Animation:()=>E,AnimationComponent:()=>Y,AnimationState:()=>jt,Collider:()=>ft,CollisionComponent:()=>P,CollisionEventType:()=>It,Component:()=>f,ForceMode:()=>z,InputComponent:()=>Z,InputType:()=>x,Justification:()=>bt,LightComponent:()=>$,LightType:()=>xt,Material:()=>I,Mesh:()=>K,MeshAttribute:()=>g,MeshAttributeAccessor:()=>q,MeshComponent:()=>Q,MeshIndexType:()=>A,Object:()=>d,PhysXComponent:()=>L,Physics:()=>J,RayHit:()=>O,Scene:()=>X,Shape:()=>S,Skin:()=>V,TextComponent:()=>G,TextEffect:()=>yt,Texture:()=>W,Type:()=>gt,ViewComponent:()=>R,_images:()=>w,_initPhysics:()=>Ut,_sceneLoadedCallback:()=>B,_wrapComponent:()=>M,arSupported:()=>rt,canvas:()=>nt,init:()=>St,isString:()=>N,loadRuntime:()=>vt,math:()=>ct,onSceneLoaded:()=>Ft,onXRSessionEnd:()=>Tt,onXRSessionStart:()=>At,onXRSupported:()=>Et,physics:()=>j,registerComponent:()=>ut,reset:()=>Ct,scene:()=>it,textures:()=>lt,updateTempMemory:()=>at,vrSupported:()=>st,xrSession:()=>C});var tt=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]));var et=()=>(async o=>{try{return typeof MessageChannel!="undefined"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(o)}catch(t){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]));var pt="Misaligned pointer: please report a bug",H={},k=[],mt=["_id","_manager","type","_type","active"];function ut(o,t,e){_WL.registerComponent(o,t,e)}var gt={Bool:1<<1,Int:1<<2,Float:1<<3,String:1<<4,Enum:1<<5,Object:1<<6,Mesh:1<<7,Texture:1<<8,Material:1<<9,Animation:1<<10,Skin:1<<11};var ft={Sphere:0,AxisAlignedBox:1,Box:2};var wt={Left:1,Center:2,Right:3};var bt={Line:1,Middle:2,Top:3,Bottom:4};var yt={None:0,Outline:1};var x={Head:0,EyeLeft:1,EyeRight:2,ControllerLeft:3,ControllerRight:4,RayLeft:5,RayRight:6};var xt={Point:1,Spot:2,Sun:3};var jt={Playing:1,Paused:2,Stopped:3};var z={Force:0,Impulse:1,VelocityChange:2,Acceleration:3};var It={Touch:0,TouchLost:1,TriggerTouch:2,TriggerTouchLost:3};var S={None:0,Sphere:1,Capsule:2,Box:3,Plane:4,ConvexMesh:5,TriangleMesh:6};var nt=null,C=null,At=[o=>{C=o}],Tt=[()=>{C=null}],Et=[(o,t)=>{o=="ar"&&(rt=t),o=="vr"&&(st=t)}],Ft=[],rt,st,it,j,w=[],B=[],a=null,u=0,s=null,U=null,b=null,T=null,ot=null;function St(){it=new X,nt=typeof document=="undefined"?null:document.getElementById("canvas"),H={},k=[],_t(1024)}function Ct(){H={},k.length=0,w.length=0,B.length=0,_WL.reset()}function Ut(){j=new J}function _t(o){console.log("Allocating temp mem:",o),u=o,a&&_free(a),a=_malloc(u),at()}function D(o){u>=o||_t(Math.ceil(o/1024)*1024)}function at(){s=new Float32Array(HEAP8.buffer,a,u>>2),U=new Int32Array(HEAP8.buffer,a,u>>2),b=new Uint32Array(HEAP8.buffer,a,u>>2),T=new Uint16Array(HEAP8.buffer,a,u>>1),ot=new Uint8Array(HEAP8.buffer,a,u)}function Pt(o){return D(o*2),T}function Lt(o){return D(o*4),s}var X=class{constructor(){this._rayHit=_malloc(4*(3*4+3*4+4+2)+4),this._hit=new O(this._rayHit),this.onPreRender=[],this.onPostRender=[]}get activeViews(){let t=_wl_scene_get_active_views(a,16),e=[],n=d._typeIndexFor("view");for(let r=0;r<t;++r)e.push(new R(n,U[r]));return e}rayCast(t,e,n){return _wl_scene_ray_cast(t[0],t[1],t[2],e[0],e[1],e[2],n,this._rayHit),this._hit}addObject(t){let e=t?t.objectId:0,n=_wl_scene_add_object(e);return d._wrapObject(n)}addObjects(t,e,n){let r=e?e.objectId:0;D(t*2);let i=_wl_scene_add_objects(r,t,n||0,a,u>>1),_=T.subarray(0,i);return Array.from(_,d._wrapObject)}reserveObjects(t,e){e=e||{};let n=d._typeIndexFor("js"),r=U.subarray();r.fill(0);for(let i of Object.entries(e)){let _=d._typeIndexFor(i[0]);r[_<0?n:_]+=i[1]}_wl_scene_reserve_objects(t,a)}set clearColor(t){_wl_scene_set_clearColor(t[0],t[1],t[2],t[3])}set colorClearEnabled(t){_wl_scene_enableColorClear(t)}load(t){let e=lengthBytesUTF8(t)+1,n=_malloc(e);stringToUTF8(t,n,e),_wl_load_scene(n),_free(n)}append(t,e){e=e||{};let n=!!e.loadGltfExtensions,r=lengthBytesUTF8(t)+1,i=_malloc(r);stringToUTF8(t,i,r);let _=B.length,l=new Promise((h,p)=>{B[_]={success:(c,m)=>{let y=d._wrapObject(c);h(m?{root:y,extensions:m}:y)},error:()=>p()}});return _wl_append_scene(i,n,_),_free(i),l}_unmarshallGltfExtensions(t){let e={root:{},mesh:{},node:{},idMapping:{}},n=0,r=()=>{let c=t[n++],m=t[n++];return _WL.UTF8ViewToString(c,c+m)},i=t[n++],_=new Array(i);for(let c=0;c<i;++c)_[c]=t[n++];e.idMapping=_;let l=t[n++];for(let c=0;c<l;++c){let m=t[n++];e.mesh[_[m]]=JSON.parse(r())}let h=t[n++];for(let c=0;c<h;++c){let m=t[n++];e.node[_[m]]=JSON.parse(r())}let p=r();return p&&(e.root=JSON.parse(p)),e}reset(){_wl_scene_reset()}};var f=class{constructor(t=-1,e=-1){this._manager=t,this._id=e,this._object=null,this._type=null}get type(){return this._type||d._typeNameFor(this._manager)}get object(){if(!this._object){let t=_wl_component_get_object(this._manager,this._id);this._object=d._wrapObject(t)}return this._object}set active(t){_wl_component_setActive(this._manager,this._id,t)}get active(){return _wl_component_isActive(this._manager,this._id)!=0}destroy(){_wl_component_remove(this._manager,this._id),this._manager=void 0,this._id=void 0}equals(t){return t?this._manager==t._manager&&this._id==t._id:!1}};var P=class extends f{get collider(){return _wl_collision_component_get_collider(this._id)}set collider(t){_wl_collision_component_set_collider(this._id,t)}get extents(){return new Float32Array(HEAPF32.buffer,_wl_collision_component_get_extents(this._id),3)}set extents(t){this.extents.set(t)}get group(){return _wl_collision_component_get_group(this._id)}set group(t){_wl_collision_component_set_group(this._id,t)}queryOverlaps(){let t=_wl_collision_component_query_overlaps(this._id,a,u>>1),e=new Array(t);for(let n=0;n<t;++n)e[n]=new P(this._manager,T[n]);return e}};var G=class extends f{get alignment(){return _wl_text_component_get_horizontal_alignment(this._id)}set alignment(t){_wl_text_component_set_horizontal_alignment(this._id,t)}get justification(){return _wl_text_component_get_vertical_alignment(this._id)}set justification(t){_wl_text_component_set_vertical_alignment(this._id,t)}get characterSpacing(){return _wl_text_component_get_character_spacing(this._id)}set characterSpacing(t){_wl_text_component_set_character_spacing(this._id,t)}get lineSpacing(){return _wl_text_component_get_line_spacing(this._id)}set lineSpacing(t){_wl_text_component_set_line_spacing(this._id,t)}get effect(){return _wl_text_component_get_effect(this._id)}set effect(t){_wl_text_component_set_effect(this._id,t)}get text(){return UTF8ToString(_wl_text_component_get_text(this._id))}set text(t){let e=lengthBytesUTF8(t)+1,n=_malloc(e);stringToUTF8(t,n,e),_wl_text_component_set_text(this._id,n),_free(n)}set material(t){_wl_text_component_set_material(this._id,t?t._index:0)}get material(){return I.wrap(_wl_text_component_get_material(this._id))}};var R=class extends f{get projectionMatrix(){return new Float32Array(HEAPF32.buffer,_wl_view_component_get_projection_matrix(this._id),16)}get near(){return _wl_view_component_get_near(this._id)}set near(t){_wl_view_component_set_near(this._id,t)}get far(){return _wl_view_component_get_far(this._id)}set far(t){_wl_view_component_set_far(this._id,t)}get fov(){return _wl_view_component_get_fov(this._id)}set fov(t){_wl_view_component_set_fov(this._id,t)}};var Z=class extends f{get inputType(){return _wl_input_component_get_type(this._id)}set inputType(t){_wl_input_component_set_type(this._id,t)}get xrInputSource(){if(C){for(let t of C.inputSources)if(t.handedness==this.handedness)return t}return null}get handedness(){let t=this.inputType;return t==x.ControllerRight||t==x.RayRight||t==x.EyeRight?"right":t==x.ControllerLeft||t==x.RayLeft||t==x.EyeLeft?"left":null}};var $=class extends f{get color(){return new Float32Array(HEAPF32.buffer,_wl_light_component_get_color(this._id),4)}get lightType(){return _wl_light_component_get_type(this._id)}set lightType(t){return _wl_light_component_set_type(this._id,t)}};var Y=class extends f{set animation(t){_wl_animation_component_set_animation(this._id,t._index)}get animation(){return new E(_wl_animation_component_get_animation(this._id))}set playCount(t){_wl_animation_component_set_playCount(this._id,t)}get playCount(){return _wl_animation_component_get_playCount(this._id)}set speed(t){_wl_animation_component_set_speed(this._id,t)}get speed(){return _wl_animation_component_get_speed(this._id)}play(){_wl_animation_component_play(this._id)}stop(){_wl_animation_component_stop(this._id)}pause(){_wl_animation_component_pause(this._id)}get state(){return _wl_animation_component_state(this._id)}};var Q=class extends f{set material(t){_wl_mesh_component_set_material(this._id,t?t._index:0)}get material(){return I.wrap(_wl_mesh_component_get_material(this._id))}get mesh(){return new K(_wl_mesh_component_get_mesh(this._id))}set mesh(t){_wl_mesh_component_set_mesh(this._id,t._index)}get skin(){return new V(_wl_mesh_component_get_skin(this._id))}set skin(t){_wl_mesh_component_set_skin(this._id,t._index)}};var L=class extends f{set static(t){_wl_physx_component_set_static(this._id,t)}get static(){return!!_wl_physx_component_get_static(this._id)}set kinematic(t){_wl_physx_component_set_kinematic(this._id,t)}get kinematic(){return!!_wl_physx_component_get_kinematic(this._id)}set shape(t){_wl_physx_component_set_shape(this._id,t)}get shape(){return _wl_physx_component_get_shape(this._id)}set shapeData(t){t==null||![S.TriangleMesh,S.ConvexMesh].includes(this.shape)||_wl_physx_component_set_shape_data(this._id,t.index)}get shapeData(){return[S.TriangleMesh,S.ConvexMesh].includes(this.shape)?{index:_wl_physx_component_get_shape_data(this._id)}:null}set extents(t){this.extents.set(t)}get extents(){let t=_wl_physx_component_get_extents(this._id);return new Float32Array(HEAPF32.buffer,t,3)}get staticFriction(){return _wl_physx_component_get_staticFriction(this._id)}set staticFriction(t){_wl_physx_component_set_staticFriction(this._id,t)}get dynamicFriction(){return _wl_physx_component_get_dynamicFriction(this._id)}set dynamicFriction(t){_wl_physx_component_set_dynamicFriction(this._id,t)}get bounciness(){return _wl_physx_component_get_bounciness(this._id)}set bounciness(t){_wl_physx_component_set_bounciness(this._id,t)}get linearDamping(){return _wl_physx_component_get_linearDamping(this._id)}set linearDamping(t){_wl_physx_component_set_linearDamping(this._id,t)}get angularDamping(){return _wl_physx_component_get_angularDamping(this._id)}set angularDamping(t){_wl_physx_component_set_angularDamping(this._id,t)}set linearVelocity(t){_wl_physx_component_set_linearVelocity(this._id,t[0],t[1],t[2])}get linearVelocity(){return _wl_physx_component_get_linearVelocity(this._id,a),new Float32Array(HEAPF32.buffer,a,3)}set angularVelocity(t){_wl_physx_component_set_angularVelocity(this._id,t[0],t[1],t[2])}get angularVelocity(){return _wl_physx_component_get_angularVelocity(this._id,a),new Float32Array(HEAPF32.buffer,a,3)}set mass(t){_wl_physx_component_set_mass(this._id,t)}get mass(){return _wl_physx_component_get_mass(this._id)}set massSpaceInteriaTensor(t){_wl_physx_component_set_massSpaceInertiaTensor(this._id,t[0],t[1],t[2])}addForce(t,e,n,r,i){e=e||z.Force,r?_wl_physx_component_addForceAt(this._id,t[0],t[1],t[2],e,!!n,r[0],r[1],r[2],!!i):_wl_physx_component_addForce(this._id,t[0],t[1],t[2],e,!!n)}addTorque(t,e){e=e||z.Force,_wl_physx_component_addTorque(this._id,t[0],t[1],t[2],e)}onCollision(t){return this.onCollisionWith(this,t)}onCollisionWith(t,e){return j._callbacks[this._id]=j._callbacks[this._id]||[],j._callbacks[this._id].push(e),_wl_physx_component_addCallback(this._id,t._id||this._id)}removeCollisionCallback(t){let e=_wl_physx_component_removeCallback(this._id,t);e&&j._callbacks[this._id].splice(-e)}};for(let o of["static","extents","staticFriction","dynamicFriction","bounciness","linearDamping","angularDamping","shape","shapeData","kinematic","linearVelocity","angularVelocity","mass"])Object.defineProperty(L.prototype,o,{enumerable:!0});var J=class{constructor(){this._rayHit=_malloc(4*(3*4+3*4+4+2)+4),this._hit=new O(this._rayHit),this._callbacks={}}rayCast(t,e,n,r){return typeof r=="undefined"&&(r=100),_wl_physx_ray_cast(t[0],t[1],t[2],e[0],e[1],e[2],n,r||100,this._rayHit),this._hit}_callCollisionCallback(t,e,n,r){j._callbacks[t][e](n,new L(d._typeIndexFor("physx"),r))}};var K=class{static get VERTEX_FLOAT_SIZE(){return 3+3+2}static get VERTEX_SIZE(){return this.VERTEX_FLOAT_SIZE*4}static get POS(){return{X:0,Y:1,Z:2}}static get TEXCOORD(){return{U:3,V:4}}static get NORMAL(){return{X:5,Y:6,Z:7}}constructor(t){if(typeof t=="object"){if(!t.vertexCount&&t.vertexData&&(t.vertexCount=t.vertexData.length/WL.Mesh.VERTEX_FLOAT_SIZE),!t.vertexCount)throw new Error("Missing parameter 'vertexCount'");let e=null,n=0;if(t.indexData){let i=t.indexType||WL.MeshIndexType.UnsignedShort;switch(n=t.indexData.length*i,e=_malloc(n),i){case A.UnsignedByte:HEAPU8.set(t.indexData,e);break;case A.UnsignedShort:HEAPU16.set(t.indexData,e>>1);break;case A.UnsignedInt:HEAPU32.set(t.indexData,e>>2);break}}let{skinned:r=!1}=t;if(this._index=_wl_mesh_create(e,n,t.indexType,t.vertexCount,r),t.vertexData){let i=this.attribute(WL.MeshAttribute.Position),_=this.attribute(WL.MeshAttribute.Normal),l=this.attribute(WL.MeshAttribute.TextureCoordinate);for(let h=0;h<t.vertexCount;++h){let p=h*WL.Mesh.VERTEX_FLOAT_SIZE;i.set(h,t.vertexData.subarray(p,p+3)),l.set(h,t.vertexData.subarray(p+3,p+5)),_.set(h,t.vertexData.subarray(p+5,p+8))}}}else this._index=t}get vertexData(){let t=_wl_mesh_get_vertexData(this._index,a);return new Float32Array(HEAPF32.buffer,t,WL.Mesh.VERTEX_FLOAT_SIZE*HEAPU32[a/4])}get vertexCount(){return _wl_mesh_get_vertexCount(this._index)}get indexData(){let t=_wl_mesh_get_indexData(this._index,a,a+4);if(t===null)return null;let e=HEAPU32[a/4];switch(HEAPU32[a/4+1]){case A.UnsignedByte:return new Uint8Array(HEAPU8.buffer,t,e);case A.UnsignedShort:return new Uint16Array(HEAPU16.buffer,t,e);case A.UnsignedInt:return new Uint32Array(HEAPU32.buffer,t,e)}}update(){_wl_mesh_update(this._index)}getBoundingSphere(t){return t=t||new Float32Array(4),_wl_mesh_get_boundingSphere(this._index,a),t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t}attribute(t){if(typeof t!="number")throw new TypeError("Expected number, but got "+typeof t);if(_wl_mesh_get_attribute(this._index,t,a),b[0]==255)return null;let e=new q(t);return e._attribute=b[0],e._offset=b[1],e._stride=b[2],e._formatSize=b[3],e._componentCount=b[4],e.length=this.vertexCount,e}destroy(){_wl_mesh_destroy(this._index)}};var q=class{constructor(t=g.Position){switch(this._attribute=-1,this._offset=0,this._stride=0,this._formatSize=0,this._componentCount=0,this.length=0,this._tempBufferGetter=void 0,this._bufferType=void 0,t){case g.Position:case g.Normal:case g.TextureCoordinate:case g.Tangent:case g.Color:case g.JointWeight:case g.SecondaryJointWeight:this._bufferType=Float32Array,this._tempBufferGetter=Lt;break;case g.JointId:case g.SecondaryJointId:this._bufferType=Uint16Array,this._tempBufferGetter=Pt;break;default:throw new Error(`Invalid attribute accessor type: ${t}`)}}createArray(t=1){return t=t>this.length?this.length:t,new this._bufferType(t*this._componentCount)}get(t,e){if(e=e||this.createArray(),e.length%this._componentCount!=0)throw new Error(`out.length, ${v.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let n=this._tempBufferGetter(e.length),r=this._bufferType.BYTES_PER_ELEMENT,i=r*e.length,_=this._componentCount*r;_wl_mesh_get_attribute_values(this._attribute,this._formatSize,this._offset+t*this._stride,this._stride,_,n.byteOffset,i);for(let l=0;l<e.length;++l)e[l]=n[l];return e}set(t,e){if(e.length%this._componentCount!=0)throw new Error(`out.length, ${e.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let n=this._bufferType.BYTES_PER_ELEMENT,r=n*e.length,i=this._componentCount*n;if(e.buffer!=HEAPU8.buffer){let _=this._tempBufferGetter(e.length);_.set(e),e=_}return _wl_mesh_set_attribute_values(this._attribute,i,e.byteOffset,r,this._formatSize,this._offset+t*this._stride,this._stride),this}};var A={UnsignedByte:1,UnsignedShort:2,UnsignedInt:4};var g={Position:0,Tangent:1,Normal:2,TextureCoordinate:3,Color:4,JointId:5,JointWeight:6,SecondaryJointId:7,SecondaryJointWeight:8};var I=class{constructor(t){this._index=t}get shader(){return UTF8ToString(_wl_material_get_shader(this._index))}clone(){return I.wrap(_wl_material_clone(this._index))}_paramIndex(t){let e=lengthBytesUTF8(t)+1,n=_malloc(e);stringToUTF8(t,n,e);let r=_wl_material_get_param_index(this._index,n);return _free(n),r}_paramType(t){let e=_wl_material_get_param_type(this._index,t);return{type:e&255,componentCount:e>>8&255,metaType:e>>16&255}}static wrap(t){if(t<=0)return null;let e=new I(t);return new Proxy(e,{get(n,r){let i=n._paramIndex(r);if(i!=-1){let _=n._paramType(i);if(_wl_material_get_param_value(n._index,i,a)){if(_.type==0)return _.componentCount==1?b[0]:new Uint32Array(HEAPU32.buffer,a,_.componentCount);if(_.type==1)return _.componentCount==1?U[0]:new Int32Array(HEAP32.buffer,a,_.componentCount);if(_.type==2)return _.componentCount==1?s[0]:new Float32Array(HEAPF32.buffer,a,_.componentCount);if(_.type==3)return new W(U[0])}throw new Error(`Invalid type ${_} on parameter ${i} for material ${n._index}`)}else return n[r]},set(n,r,i){let _=n._paramIndex(r);if(_>=0)if(i instanceof W)_wl_material_set_param_value_uint(n._index,_,i._id);else if(typeof i=="number")s[0]=i,_wl_material_set_param_value_float(n._index,_,a,1);else{let l=i.length;for(let h=0;h<l;++h)s[h]=i[h];_wl_material_set_param_value_float(n._index,_,a,l)}else n[r]=i;return!0}})}};var F=null,W=class{constructor(t){if(t instanceof HTMLImageElement||t instanceof HTMLVideoElement||t instanceof HTMLCanvasElement){let e=w.length;w.push(t),this._imageIndex=e,this._id=_wl_renderer_addImage(e)}else this._id=t;lt[this._id]=this}get valid(){return this._id>=0}update(){!this.valid||_wl_renderer_updateImage(this._id,this._imageIndex)}get width(){return _wl_texture_width(this._id)}get height(){return _wl_texture_height(this._id)}updateSubImage(t,e,n,r){if(!this.valid)return;F||(F=document.createElement("canvas"));let i=w[this._imageIndex];F.width=n,F.height=r,F.getContext("2d").drawImage(i,t,e,n,r,0,0,n,r),w[this._imageIndex]=F;try{_wl_renderer_updateImage(this._id,this._imageIndex,t,(i.videoHeight||i.height)-e-r)}finally{w[this._imageIndex]=i}}destroy(){_wl_texture_destroy(this._id),this._imageIndex&&(w[this._imageIndex]=null,this._imageIndex=void 0)}};var lt={load:function(o,t){let e=new Image;return t!==void 0&&(e.crossOrigin=t),e.src=o,new Promise((n,r)=>{e.onload=function(){let i=new W(e);i.valid||r("Failed to add image "+e.src+" to texture atlas. Probably incompatible format."),n(i)}})}},E=class{constructor(t){this._index=t}get duration(){return _wl_animation_get_duration(this._index)}get trackCount(){return _wl_animation_get_trackCount(this._index)}retarget(t){if(t instanceof V){let r=_wl_animation_retargetToSkin(this._index,t._index);return new E(r)}if(t.length!=this.trackCount)throw Error("Expected "+this.trackCount.toString()+" targets, but got "+t.length.toString());let e=_malloc(2*t.length);for(let r=0;r<t.length;++r)HEAPU16[e>>1+r]=t[r].objectId;let n=_wl_animation_retarget(this._index,e);return _free(e),new E(n)}};var d=class{constructor(t){this.objectId=t}get name(){return UTF8ToString(_wl_object_name(this.objectId))}set name(t){let e=lengthBytesUTF8(t)+1,n=_malloc(e);stringToUTF8(t,n,e),_wl_object_set_name(this.objectId,n),_free(n)}get parent(){let t=_wl_object_parent(this.objectId);return t==0?null:d._wrapObject(t)}get children(){let t=_wl_object_get_children_count(this.objectId);if(t===0)return[];D(t*2),_wl_object_get_children(this.objectId,a,u>>1);let e=new Array(t);for(let n=0;n<t;++n)e[n]=d._wrapObject(T[n]);return e}set parent(t){_wl_object_set_parent(this.objectId,t==null?0:t.objectId)}resetTransform(){_wl_object_reset_translation_rotation(this.objectId),_wl_object_reset_scaling(this.objectId)}resetTranslationRotation(){_wl_object_reset_translation_rotation(this.objectId)}resetRotation(){_wl_object_reset_rotation(this.objectId)}resetTranslation(){_wl_object_reset_translation(this.objectId)}resetScaling(){_wl_object_reset_scaling(this.objectId)}translate(t){_wl_object_translate(this.objectId,t[0],t[1],t[2])}translateObject(t){_wl_object_translate_obj(this.objectId,t[0],t[1],t[2])}translateWorld(t){_wl_object_translate_world(this.objectId,t[0],t[1],t[2])}rotateAxisAngleDeg(t,e){_wl_object_rotate_axis_angle(this.objectId,t[0],t[1],t[2],e)}rotateAxisAngleRad(t,e){_wl_object_rotate_axis_angle_rad(this.objectId,t[0],t[1],t[2],e)}rotateAxisAngleDegObject(t,e){_wl_object_rotate_axis_angle_obj(this.objectId,t[0],t[1],t[2],e)}rotateAxisAngleRadObject(t,e){_wl_object_rotate_axis_angle_rad_obj(this.objectId,t[0],t[1],t[2],e)}rotate(t){_wl_object_rotate_quat(this.objectId,t[0],t[1],t[2],t[3])}rotateObject(t){_wl_object_rotate_quat_obj(this.objectId,t[0],t[1],t[2],t[3])}scale(t){_wl_object_scale(this.objectId,t[0],t[1],t[2])}get transformLocal(){return new Float32Array(HEAPF32.buffer,_wl_object_trans_local(this.objectId),8)}set transformLocal(t){this.transformLocal.set(t),this.setDirty()}getTranslationLocal(t){return _wl_object_get_translation_local(this.objectId,a),t[0]=s[0],t[1]=s[1],t[2]=s[2],t}getTranslationWorld(t){return _wl_object_get_translation_world(this.objectId,a),t[0]=s[0],t[1]=s[1],t[2]=s[2],t}setTranslationLocal(t){_wl_object_set_translation_local(this.objectId,t[0],t[1],t[2])}setTranslationWorld(t){_wl_object_set_translation_world(this.objectId,t[0],t[1],t[2])}get transformWorld(){return new Float32Array(HEAPF32.buffer,_wl_object_trans_world(this.objectId),8)}set transformWorld(t){this.transformWorld.set(t),_wl_object_trans_world_to_local(this.objectId)}get scalingLocal(){return new Float32Array(HEAPF32.buffer,_wl_object_scaling_local(this.objectId),3)}set scalingLocal(t){this.scalingLocal.set(t),this.setDirty()}get scalingWorld(){return new Float32Array(HEAPF32.buffer,_wl_object_scaling_world(this.objectId),3)}set scalingWorld(t){this.scalingWorld.set(t),_wl_object_scaling_world_to_local(this.objectId)}get rotationLocal(){return this.transformLocal.subarray(0,4)}get rotationWorld(){return this.transformWorld.subarray(0,4)}set rotationLocal(t){_wl_object_set_rotation_local(this.objectId,t[0],t[1],t[2],t[3])}set rotationWorld(t){_wl_object_set_rotation_world(this.objectId,t[0],t[1],t[2],t[3])}getForward(t){return t[0]=0,t[1]=0,t[2]=-1,this.transformVectorWorld(t),t}getUp(t){return t[0]=0,t[1]=1,t[2]=0,this.transformVectorWorld(t),t}getRight(t){return t[0]=1,t[1]=0,t[2]=0,this.transformVectorWorld(t),t}transformVectorWorld(t,e){return e=e||t,s[0]=e[0],s[1]=e[1],s[2]=e[2],_wl_object_transformVectorWorld(this.objectId,a),t[0]=s[0],t[1]=s[1],t[2]=s[2],t}transformVectorLocal(t,e){return e=e||t,s[0]=e[0],s[1]=e[1],s[2]=e[2],_wl_object_transformVectorLocal(this.objectId,a),t[0]=s[0],t[1]=s[1],t[2]=s[2],t}transformPointWorld(t,e){return e=e||t,s[0]=e[0],s[1]=e[1],s[2]=e[2],_wl_object_transformPointWorld(this.objectId,a),t[0]=s[0],t[1]=s[1],t[2]=s[2],t}transformPointLocal(t,e){return e=e||t,s[0]=e[0],s[1]=e[1],s[2]=e[2],_wl_object_transformPointLocal(this.objectId,a),t[0]=s[0],t[1]=s[1],t[2]=s[2],t}transformVectorInverseWorld(t,e){return e=e||t,s[0]=e[0],s[1]=e[1],s[2]=e[2],_wl_object_transformVectorInverseWorld(this.objectId,a),t[0]=s[0],t[1]=s[1],t[2]=s[2],t}transformVectorInverseLocal(t,e){return e=e||t,s[0]=e[0],s[1]=e[1],s[2]=e[2],_wl_object_transformVectorInverseLocal(this.objectId,a),t[0]=s[0],t[1]=s[1],t[2]=s[2],t}transformPointInverseWorld(t,e){return e=e||t,s[0]=e[0],s[1]=e[1],s[2]=e[2],_wl_object_transformPointInverseWorld(this.objectId,a),t[0]=s[0],t[1]=s[1],t[2]=s[2],t}transformPointInverseLocal(t,e){return e=e||t,s.set(e),_wl_object_transformPointInverseLocal(this.objectId,a),t[0]=s[0],t[1]=s[1],t[2]=s[2],t}toWorldSpaceTransform(t,e){return e=e||t,s.set(e),_wl_object_toWorldSpaceTransform(this.objectId,a),t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t}toLocalSpaceTransform(t,e){let n=this.parent;return n?n.toObjectSpaceTransform(e):(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7]),t}toObjectSpaceTransform(t,e){return e=e||t,s.set(e),_wl_object_toObjectSpaceTransform(this.objectId,a),t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t}lookAt(t,e=[0,1,0]){_wl_object_lookAt(this.objectId,t[0],t[1],t[2],e[0],e[1],e[2])}destroy(){_wl_scene_remove_object(this.objectId),this.objectId=null}setDirty(){_wl_object_set_dirty(this.objectId)}set active(t){let e=this.getComponents();for(let n of e)n.active=t}getComponent(t,e){let n=N(t)?t:t.TypeName,r=lengthBytesUTF8(n)+1,i=_malloc(r);stringToUTF8(n,i,r);let _=_wl_get_component_manager_index(i);if(_free(i),_<0){let h=_WL._componentTypeIndices[n],p=_wl_get_js_component_index(this.objectId,h,e||0);return p<0?null:_WL._components[p]}let l=_wl_get_component_id(this.objectId,_,e||0);return M(n,_,l)}getComponents(t){let e=null,n=null;t&&(n=N(t)?t:t.TypeName,e=d._typeIndexFor(n));let r=[],i=Math.floor(u/3*2),_=_wl_object_get_components(this.objectId,a,i),l=2*_;_wl_object_get_component_types(this.objectId,a+l,i);let h=d._typeIndexFor("js");for(let p=0;p<_;++p){let c=ot[p+l],m=T[p];if(c==h){let y=_WL._components[_wl_get_js_component_index_for_id(m)];(e===null||y.type==n)&&r.push(y);continue}if(e===null){let y=d._typeNameFor(c);r.push(M(y,c,m))}else c==e&&r.push(M(n,e,m))}return r}addComponent(t,e){let n=N(t)?t:t.TypeName,r=d._typeIndexFor(n),i=null,_=null;if(r<0){if(!(n in _WL._componentTypeIndices))throw new TypeError("Unknown component type '"+n+"'");let l=_wl_object_add_js_component(this.objectId,_WL._componentTypeIndices[n]);_=_wl_get_js_component_index_for_id(l),i=_WL._components[_]}else{let l=_wl_object_add_component(this.objectId,r);i=M(n,r,l)}if(e!==void 0)for(let l in e)mt.includes(l)||(i[l]=e[l]);return r<0&&_wljs_component_init(_),(!e||!("active"in e&&!e.active))&&(i.active=!0),i}get changed(){return!!_wl_object_is_changed(this.objectId)}equals(t){return t?this.objectId==t.objectId:!1}static _typeIndexFor(t){let e=lengthBytesUTF8(t)+1,n=_malloc(e);stringToUTF8(t,n,e);let r=_wl_get_component_manager_index(n);return _free(n),r}static _typeNameFor(t){return UTF8ToString(_wl_component_manager_name(t))}static _wrapObject(t){let e=k[t]||(k[t]=new d(t));return e.objectId=t,e}},V=class{constructor(t){this._index=t}get jointCount(){return _wl_skin_get_joint_count(this._index)}get jointIds(){return new Uint16Array(HEAPU16.buffer,_wl_skin_joint_ids(this._index),this.jointCount)}get inverseBindTransforms(){return new Float32Array(HEAPF32.buffer,_wl_skin_inverse_bind_transforms(this._index),8*this.jointCount)}get inverseBindScalings(){return new Float32Array(HEAPF32.buffer,_wl_skin_inverse_bind_scalings(this._index),3*this.jointCount)}};var O=class{constructor(t){assert((this._ptr&3)==0,pt),this._ptr=t}get locations(){let t=this._ptr,e=[];for(let n=0;n<this.hitCount;++n)e.push(new Float32Array(HEAPF32.buffer,t+12*n,3));return e}get normals(){let t=this._ptr+48,e=[];for(let n=0;n<this.hitCount;++n)e.push(new Float32Array(HEAPF32.buffer,t+12*n,3));return e}get distances(){let t=this._ptr+48*2;return new Float32Array(HEAPF32.buffer,t,this.hitCount)}get objects(){let t=this._ptr+(48*2+16),e=new Uint16Array(HEAPU16.buffer,t,this.hitCount);return[e[0]<=0?null:d._wrapObject(e[0]),e[1]<=0?null:d._wrapObject(e[1]),e[2]<=0?null:d._wrapObject(e[2]),e[3]<=0?null:d._wrapObject(e[3])]}get hitCount(){return Math.min(HEAPU32[this._ptr/4+30],4)}};var ct=class{static cubicHermite(t,e,n,r,i,_){s.subarray(0).set(e),s.subarray(4).set(n),s.subarray(8).set(r),s.subarray(12).set(i);let l=e.length==4;return _wl_math_cubicHermite(a+4*16,a+4*0,a+4*4,a+4*8,a+4*12,_,l),t[0]=s[16],t[1]=s[17],t[2]=s[18],l&&(t[3]=s[19]),t}};function N(o){return o&&(typeof o=="string"||o.constructor===String)}function M(o,t,e){if(e<0)return null;let n=H[t]||(H[t]=[]);if(n[e])return n[e];let r;if(o=="collision")r=new P;else if(o=="text")r=new G;else if(o=="view")r=new R;else if(o=="mesh")r=new Q;else if(o=="input")r=new Z;else if(o=="light")r=new $;else if(o=="animation")r=new Y;else if(o=="physx")r=new L;else{let i=_WL._componentTypeIndices[o],_=_WL._componentTypes[i];r=new _}return r._manager=t,r._id=e,n[e]=r,r}async function Mt(){let[o,t]=await Promise.all([tt(),et()]);return o?console.log("WASM SIMD is supported"):console.warn("WASM SIMD is not supported"),t?self.crossOriginIsolated?console.log("WASM Threads is supported"):console.warn("WASM Threads is supported, but the page is not crossOriginIsolated, therefore thread support is disabled."):console.warn("WASM Threads is not supported"),t=t&&self.crossOriginIsolated,{simdSupported:o,threadsSupported:t}}async function vt(o,t={}){let{simdSupported:e,threadsSupported:n}=await Mt(),{simd:r=e,threads:i=n}=t,_=`${o}${r?"-simd":""}${i?"-threads":""}`,h=await(await fetch(_+".wasm")).arrayBuffer();return new Promise(p=>{window.Module={worker:`${_}.worker.js`,wasm:h},window.Module.ready=function(){window._wl_application_start(),p()};let c=document.createElement("script");c.type="text/javascript",c.src=`${_}.js`,document.body.append(c)})}return Wt;})();
//# sourceMappingURL=wonderland.min.js.map
